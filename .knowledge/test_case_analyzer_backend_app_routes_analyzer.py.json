{"is_source_file": true, "format": "Python", "description": "This file defines Flask routes for a web service that handles uploading test case Excel files, analyzing their similarity using USE embeddings or Azure OpenAI embeddings, and providing comparison results via JSON or Excel downloads. It includes helper functions for database access, file handling, and external API calls, as well as classes and methods for the API endpoints.", "external_files": ["flask", "flask.views", "flask_smorest", "werkzeug.utils", "pandas", "requests", "sqlite3", "numpy", "tensorflow_hub"], "external_methods": ["hub.load", "np.array", "np.dot", "np.linalg.norm", "requests.post", "pd.read_excel", "pd.DataFrame", "pd.ExcelWriter", "send_file"], "published": ["USEEncoder", "get_db_connection", "save_uploaded_file", "parse_excel_test_cases", "insert_file_and_cases", "fetch_test_cases_for_file", "call_azure_openai_similarity", "blp"], "classes": [{"name": "USEEncoder", "description": "Wrapper around TensorFlow Hub's Universal Sentence Encoder with singleton model loading."}], "methods": [{"name": "load_model(cls)", "description": "Loads the USE model from TensorFlow Hub if not already loaded, using a class-level singleton.", "scope": "USEEncoder", "scopeKind": "class"}, {"name": "encode(cls, texts)", "description": "Encodes a list of texts into embedding vectors using the USE model.", "scope": "USEEncoder", "scopeKind": "class"}, {"name": "get_db_connection()", "description": "Creates and returns a SQLite database connection based on environment variable 'SQLITE_DB'.", "scope": "", "scopeKind": ""}, {"name": "save_uploaded_file(file_storage, upload_folder)", "description": "Saves an uploaded file to a specified folder with a timestamped filename.", "scope": "", "scopeKind": ""}, {"name": "parse_excel_test_cases(file_path)", "description": "Parses an Excel file to extract test case names based on heuristic column detection.", "scope": "", "scopeKind": ""}, {"name": "insert_file_and_cases(file_path, filename, test_cases)", "description": "Inserts uploaded file info and test cases into the database.", "scope": "", "scopeKind": ""}, {"name": "fetch_test_cases_for_file(file_id)", "description": "Retrieves test case IDs and names associated with a specific file.", "scope": "", "scopeKind": ""}, {"name": "call_azure_openai_similarity(texts1, texts2)", "description": "Calls Azure OpenAI API to generate embedding vectors for texts and computes cosine similarity matrix.", "scope": "", "scopeKind": ""}, {"name": "get(self)", "scope": "DownloadView", "scopeKind": "class", "description": "unavailable"}, {"name": "get_embeds(batch)", "scope": "call_azure_openai_similarity", "scopeKind": "function", "description": "unavailable"}, {"name": "post(self)", "scope": "UploadView", "scopeKind": "class", "description": "unavailable"}], "calls": ["USEEncoder.load_model", "USEEncoder.encode", "get_db_connection", "save_uploaded_file", "parse_excel_test_cases", "insert_file_and_cases", "fetch_test_cases_for_file", "call_azure_openai_similarity", "pd.read_excel", "pd.ExcelWriter", "send_file"], "search-terms": ["analyzer.py", "Flask Blueprint", "test_case_files", "test_cases", "semantic similarity", "Azure OpenAI", "Universal Sentence Encoder", "Excel test cases", "test case analysis", "file upload"], "state": 2, "file_id": 7, "knowledge_revision": 15, "git_revision": "157cf26f1959598cabaa99b764309a6a5311ca0a", "ctags": [{"_type": "tag", "name": "CompareView", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^class CompareView(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "DownloadView", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^class DownloadView(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "USEEncoder", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^class USEEncoder:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UploadView", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^class UploadView(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_model", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^    _model = None$/", "language": "Python", "kind": "variable", "scope": "USEEncoder", "scopeKind": "class"}, {"_type": "tag", "name": "blp", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^blp = Blueprint(\"Analyzer\", __name__, url_prefix=\"\\/analyze\", description=\"Test Case Analysis en/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "call_azure_openai_similarity", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^def call_azure_openai_similarity(texts1, texts2):$/", "language": "Python", "kind": "function", "signature": "(texts1, texts2)"}, {"_type": "tag", "name": "encode", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^    def encode(cls, texts):$/", "language": "Python", "kind": "member", "signature": "(cls, texts)", "scope": "USEEncoder", "scopeKind": "class"}, {"_type": "tag", "name": "fetch_test_cases_for_file", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^def fetch_test_cases_for_file(file_id):$/", "language": "Python", "kind": "function", "signature": "(file_id)"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^    def get(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "DownloadView", "scopeKind": "class"}, {"_type": "tag", "name": "get_db_connection", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^def get_db_connection():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_embeds", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^    def get_embeds(batch):$/", "file": true, "language": "Python", "kind": "function", "signature": "(batch)", "scope": "call_azure_openai_similarity", "scopeKind": "function"}, {"_type": "tag", "name": "hub", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^import tensorflow_hub as hub$/", "language": "Python", "kind": "namespace", "nameref": "module:tensorflow_hub"}, {"_type": "tag", "name": "insert_file_and_cases", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^def insert_file_and_cases(file_path, filename, test_cases):$/", "language": "Python", "kind": "function", "signature": "(file_path, filename, test_cases)"}, {"_type": "tag", "name": "load_model", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^    def load_model(cls):$/", "language": "Python", "kind": "member", "signature": "(cls)", "scope": "USEEncoder", "scopeKind": "class"}, {"_type": "tag", "name": "np", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^import numpy as np$/", "language": "Python", "kind": "namespace", "nameref": "module:numpy"}, {"_type": "tag", "name": "parse_excel_test_cases", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^def parse_excel_test_cases(file_path):$/", "language": "Python", "kind": "function", "signature": "(file_path)"}, {"_type": "tag", "name": "pd", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^import pandas as pd$/", "language": "Python", "kind": "namespace", "nameref": "module:pandas"}, {"_type": "tag", "name": "post", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^    def post(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "CompareView", "scopeKind": "class"}, {"_type": "tag", "name": "post", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^    def post(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "UploadView", "scopeKind": "class"}, {"_type": "tag", "name": "save_uploaded_file", "path": "/home/kavia/workspace/code-generation/test-case-comparison-tool-76d090e3/test_case_analyzer_backend/app/routes/analyzer.py", "pattern": "/^def save_uploaded_file(file_storage, upload_folder):$/", "language": "Python", "kind": "function", "signature": "(file_storage, upload_folder)"}], "hash": "70b4120737abbc841800de618bd6c8fc", "format-version": 4, "code-base-name": "test_case_analyzer_backend", "filename": "test_case_analyzer_backend/app/routes/analyzer.py", "fields": [{"name": "_model = None", "scope": "USEEncoder", "scopeKind": "class", "description": "unavailable"}, {"name": "blp = Blueprint(\"Analyzer\", __name__, url_prefix=\"\\/analyze\", description=\"Test Case Analysis en/", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"15": "157cf26f1959598cabaa99b764309a6a5311ca0a"}]}